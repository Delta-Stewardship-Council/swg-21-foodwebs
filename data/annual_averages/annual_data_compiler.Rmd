---
title: "Data compiler - annual averages"
author: "Tanya Rogers"
date: "10/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This combines the various csv files into `annual_data_compiled.csv`, and makes some plots of the time series.

```{r, message=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
```

```{r}
flow=read.csv("data/annual_averages/annual_average_deltawide_flow.csv")
nutwq=read.csv("data/annual_averages/emp_waterquality_mean.csv")
benthic=read.csv("data/annual_averages/benthic.csv")
# fish=read.csv("data/annual_averages/")
# zoop=read.csv("data/annual_averages/")

combined=flow %>% 
  full_join(nutwq, by="Year") %>% 
  full_join(benthic, by = c("Year"="year")) #%>%
  # full_join(fish) %>% 
  # full_join(zoop)

write.csv(combined, "data/annual_averages/annual_data_compiled.csv")
```

Plots

```{r, fig.width=4, fig.height=12}
datalong=gather(combined,Var,Value,2:ncol(combined))
datalong$Var=factor(datalong$Var,levels = unique(datalong$Var))

ggplot(datalong, aes(y=Value, x=Year)) +
  facet_grid(Var~., scales = "free_y") +
  geom_line() + geom_point() +
  theme_bw()
```

